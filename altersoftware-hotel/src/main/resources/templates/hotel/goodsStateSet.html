<!DOCTYPE html>
<!-- saved from url=(0053)https://getbootstrap.com/docs/4.2/examples/dashboard/ -->
<html xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">

<head th:replace="component/head :: head">
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">

    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">

    <title>用户服务中心</title>

</head>

<body>
<header th:replace="component/fram :: commonHeader"></header>

<div class="container" th:replace="component/fram :: commonMenu"></div>

<main class="col-md-9 ml-sm-auto col-lg-10 px-4" role="main">
    <div class="chartjs-size-monitor"
         style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; overflow: hidden; pointer-events: none; visibility: hidden; z-index: -1;">
        <div class="chartjs-size-monitor-expand"
             style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
            <div style="position:absolute;width:1000000px;height:1000000px;left:0;top:0"></div>
        </div>
        <div class="chartjs-size-monitor-shrink"
             style="position:absolute;left:0;top:0;right:0;bottom:0;overflow:hidden;pointer-events:none;visibility:hidden;z-index:-1;">
            <div style="position:absolute;width:200%;height:200%;left:0; top:0"></div>
        </div>
    </div>

    <div class="god">
        <form class="sendupdategoods" method="post">
            <h2 style="color: rgb(135, 106, 32);">
                <small>房间物品状态设置</small>
            </h2>
            <label class="col-sm-2 control-label">房间号</label>
            <div class="col-sm-10">
                <input class="form-control" id="selectun" name="roomNumber" placeholder="发送房间号:可选"
                       type="text">
            </div>
            <hr align="left" width="80%">
            <div class="pimg1">
                <div class="ptext">
                    <span>灯光设置</span>
                </div>
            </div>
            <section class="section1 section-light">
                <h4>温暖的灯光令您寻找到避风的港湾</h4>
                <div class="input-group input-group-lightlabel">
                    <label style="margin-right: 3%;">玄关灯光开关</label>
                    <input id="toggle-button" name="玄关灯光开光" th:value="0" type="checkbox">
                    <!--label中的for跟input的id绑定。作用是在点击label时选中input或者取消选中input-->
                    <label class="button-label" for="toggle-button">
                        <span class="circle"></span>
                        <span class="text on">开</span>
                        <span class="text off">关</span>
                    </label>
                    <label style="margin-right: 3%;margin-left: 16%;">房间灯光开关</label>
                    <input id="toggle-button1" name="房间灯光开光" th:value="0" type="checkbox">
                    <!--label中的for跟input的id绑定。作用是在点击label时选中input或者取消选中input-->
                    <label class="button-label" for="toggle-button1">
                        <span class="circle"></span>
                        <span class="text on">开</span>
                        <span class="text off">关</span>
                    </label>
                    <label style="margin-right: 3%;margin-left: 16%;">厕所灯光开关</label>
                    <input id="toggle-button2" name="厕所灯光开光" th:value="0" type="checkbox">
                    <!--label中的for跟input的id绑定。作用是在点击label时选中input或者取消选中input-->
                    <label class="button-label" for="toggle-button2">
                        <span class="circle"></span>
                        <span class="text on">开</span>
                        <span class="text off">关</span>
                    </label>
                </div>
            </section>
            <div class="pimg2">
                <div class="ptext">
                    <span>窗户设置</span>
                </div>
            </div>
            <section class="section2 section-dark">
                <h4>和风吹拂面颊，还是感受一人的宁静？由您自己决定</h4>
                <div class="input-group input-group-lightlabel">
                    <label style="margin-left: 22%;margin-right: 3%;">窗帘开关</label>
                    <input id="toggle-button3" name="窗帘开关" th:value="0" type="checkbox">
                    <!--label中的for跟input的id绑定。作用是在点击label时选中input或者取消选中input-->
                    <label class="button-label" for="toggle-button3">
                        <span class="circle"></span>
                        <span class="text on">开</span>
                        <span class="text off">关</span>
                    </label>
                    <label style="margin-right: 3%;margin-left: 22%;">窗子开关</label>
                    <input id="toggle-button4" name="窗子开关" th:value="0" type="checkbox">
                    <!--label中的for跟input的id绑定。作用是在点击label时选中input或者取消选中input-->
                    <label class="button-label" for="toggle-button4">
                        <span class="circle"></span>
                        <span class="text on">开</span>
                        <span class="text off">关</span>
                    </label>
                </div>
            </section>
            <div class="pimg3">
                <div class="ptext">
                    <span>空调设置</span>
                </div>
            </div>
            <section class="section3 section-light">
                <h4>舒适惬意的环境助您安梦</h4>
                <div class="input-group input-group-lightlabel">
                    <label style="margin-right: 3%;">空调开关</label>
                    <input id="toggle-button5" name="空调开关" th:value="0" type="checkbox">
                    <!--label中的for跟input的id绑定。作用是在点击label时选中input或者取消选中input-->
                    <label class="button-label" for="toggle-button5" th:value="0">
                        <span class="circle"></span>
                        <span class="text on">开</span>
                        <span class="text off">关</span>
                    </label>
                    <label style="margin-left:22%;margin-right: 3%;">空调模式</label>
                    <input id="toggle-button6" name="空调模式" th:value="0" type="checkbox">
                    <!--label中的for跟input的id绑定。作用是在点击label时选中input或者取消选中input-->
                    <label class="button-label1" for="toggle-button6">
                        <span class="circle"></span>
                        <span class="text on">冷</span>
                        <span class="text off">热</span>
                    </label>
                    <label style="margin-left:22%;margin-right: 3%;">空调温度</label>
                    <input id="temperature" max="30"
                           min="15"
                           name="空调温度" placeholder="22" step="1"
                           style="width:60px;border-top:none;border-left:none;border-right:none;text-align:center;outline:none;border-radius: 5px 5px 5px 5px;"
                           type="number" value="22">
                </div>
            </section>
            <div class="pimg5">
                <div class="ptext">
                    <span>您的光临就是对我们最大的支持</span>
                </div>
            </div>
            <section class="section4 section-light">
                <button class="btn btn-success" type="submit">保存设置</button>
            </section>
        </form>
    </div>

</main>

<footer th:replace="component/fram :: commonFooter"></footer>

<script>
    $(document).ready(function () {
        //空调模式
        $("#toggle-button6").click(function () {
            if ($("#toggle-button6").prop("checked")) {
                $("#toggle-button6").attr("value", "制冷");
            } else {
                $("#toggle-button6").attr("value", "制热");
            }
        });

        //空调开关
        $("#toggle-button5").click(function () {
            if ($("#toggle-button5").prop("checked")) {
                $("#toggle-button5").attr("value", "1");
            } else {
                $("#toggle-button5").attr("value", "0");
            }
        });

        //窗子
        $("#toggle-button4").click(function () {
            if ($("#toggle-button4").prop("checked")) {
                $("#toggle-button4").attr("value", "1");
            } else {
                $("#toggle-button4").attr("value", "0");
            }
        });

        //窗帘
        $("#toggle-button3").click(function () {
            if ($("#toggle-button3").prop("checked")) {
                $("#toggle-button3").attr("value", "1");
            } else {
                $("#toggle-button3").attr("value", "0");
            }
        });

        //厕所灯光
        $("#toggle-button2").click(function () {
            if ($("#toggle-button2").prop("checked")) {
                $("#toggle-button2").attr("value", "1");
            } else {
                $("#toggle-button2").attr("value", "0");
            }
        });

        //房间灯光
        $("#toggle-button1").click(function () {
            if ($("#toggle-button1").prop("checked")) {
                $("#toggle-button1").attr("value", "1");
            } else {
                $("#toggle-button1").attr("value", "0");
            }
        });

        //玄关灯光
        $("#toggle-button").click(function () {
            if ($("#toggle-button").prop("checked")) {
                $("#toggle-button").attr("value", "1");
            } else {
                $("#toggle-button").attr("value", "0");
            }
        });

    })
</script>

<script>
    function getCookie(objName) {//获取指定名称的cookie的值
        var arrStr = document.cookie.split(";");
        for (var i = 0; i < arrStr.length; i++) {
            var temp = arrStr[i].split("=");
            if (temp[0] == objName)
                return unescape(temp[1]);
        }
    }
	var tag=0;
    $(document).ready(function () {
        console.log("获取用户名Id");
        var userId = getCookie("userId");
        console.log(userId);
        $.ajax({
            url: "/hotel/record/getnumbers-bycustomer",
            type: "POST",
            contentType: "application/x-www-form-urlencoded",
            data: {
                "customerId": userId
            },
            success: function (result) {
                console.log(result);
                var data = result.module;
                $("#selectun").val(data.toString());
                // for (var i = 0; i < data.length; i++) {
                //     document.getElementById("selectun").options.add(new Option(data[i], i));
                // }
	            if (data.length ==0){
	                alert("对不起,未查到您预定的房间,如您已预定,请与前台联系");
	            } else {
	                tag = 1;
	            }
            }
        })
    });


    let submit = $('.sendupdategoods').submit(function (e) {
        if (tag ==0){
            alert("对不起,您还未预定房间");
            return false;
        }
        var roomNumber = $("#selectun").val();
        // alert(roomNumber);
        console.log(roomNumber);
        var String = roomNumber.split(",");
        // 阻止默认提交
        e.preventDefault();
        // function submit() {
        let button7 = $("#temperature").val();
        console.log("空调温度");
        console.log(button7);
        let button6 = $("#toggle-button6").val();
        console.log("空调模式");
        console.log(button6);
        let button5 = $("#toggle-button5").val();
        console.log("空调开关");
        console.log(button5);
        let button4 = $("#toggle-button4").val();
        console.log("窗户开关");
        console.log(button4);
        let button3 = $("#toggle-button3").val();
        console.log("窗帘开关");
        console.log(button3);
        let button2 = $("#toggle-button2").val();
        console.log("厕所灯光");
        console.log(button2);
        let button1 = $("#toggle-button1").val();
        console.log("房间灯光");
        console.log(button1);
        let button = $("#toggle-button").val();
        console.log("玄光灯光");
        console.log(button);
        console.log("==============================");
        let arr = [];
        let data7 = {
            roomNumber: roomNumber,
            goodsName: "空调温度",
            state: button7
        };
        if (button6 === 1) {
            button6 = "制冷";
        }
        if (button6 === 0) {
            button6 = "制热";
        }
        let data6 = {
            roomNumber: roomNumber,
            goodsName: "空调模式",
            state: button6
        };
        let data5 = {
            roomNumber: roomNumber,
            goodsName: "空调开关",
            state: button5
        };
        let data4 = {
            roomNumber: roomNumber,
            goodsName: "窗户开关",
            state: button4
        };
        let data3 = {
            roomNumber: roomNumber,
            goodsName: "窗帘开关",
            state: button3
        };
        let data2 = {
            roomNumber: roomNumber,
            goodsName: "厕所灯光",
            state: button2
        };
        let data1 = {
            roomNumber: roomNumber,
            goodsName: "房间灯光",
            state: button1
        };
        let data = {
            roomNumber: roomNumber,
            goodsName: "玄光灯光",
            state: button
        };
        arr.push(data7);
        arr.push(data6);
        arr.push(data5);
        arr.push(data4);
        arr.push(data3);
        arr.push(data2);
        arr.push(data1);
        arr.push(data);
        // 有参数post请求
        url = "/hotel/state/update-state";
        console.log(String.length);
        console.log(String);
        if (String.length == 1) {
            console.log("单一房间");
            $.ajax({
                type: "POST",
                url: url,
                dataType: "json",
                data: JSON.stringify(arr),
                traditional: true,
                contentType: "application/json",
                success: function (result) {
                    if (result.success == true) {
                        // timer = setTimeout('', 5 * 1000); //跳转
                        alert("保存成功,期待您的体验");
                    }
                },
                error: function () {
                    swal("错误", "404", "error");
                }
            });
            // alert("保存成功,期待您的体验");
        } else {
            for (var i = 0; i < String.length; i++) {
                let arrx = [];
                let data7 = {
                    roomNumber: String[i],
                    goodsName: "空调温度",
                    state: button7
                };
                if (button6 === 1) {
                    button6 = "制冷";
                }
                if (button6 === 0) {
                    button6 = "制热";
                }
                let data6 = {
                    roomNumber: String[i],
                    goodsName: "空调模式",
                    state: button6
                };
                let data5 = {
                    roomNumber: String[i],
                    goodsName: "空调开关",
                    state: button5
                };
                let data4 = {
                    roomNumber: String[i],
                    goodsName: "窗户开关",
                    state: button4
                };
                let data3 = {
                    roomNumber: String[i],
                    goodsName: "窗帘开关",
                    state: button3
                };
                let data2 = {
                    roomNumber: String[i],
                    goodsName: "厕所灯光",
                    state: button2
                };
                let data1 = {
                    roomNumber: String[i],
                    goodsName: "房间灯光",
                    state: button1
                };
                let data = {
                    roomNumber: String[i],
                    goodsName: "玄光灯光",
                    state: button
                };
                arrx.push(data7);
                arrx.push(data6);
                arrx.push(data5);
                arrx.push(data4);
                arrx.push(data3);
                arrx.push(data2);
                arrx.push(data1);
                arrx.push(data);
                console.log(arrx);
                $.ajax({
                    type: "POST",
                    url: url,
                    dataType: "json",
                    data: JSON.stringify(arrx),
                    traditional: true,
                    async: false,
                    contentType: "application/json",
                    success: function (result) {
                    },
                    error: function () {
                        swal("错误", "404", "error");
                    }
                });
                // timer = setTimeout('', 20 * 1000); //等待
            }
            alert("保存成功,期待您的体验");
            // alert("保存成功,期待您的体验");
            // timer = setTimeout('window.location.href = "/hotel/user/home"', 1 * 1000); //跳转

        }

    });

    function parameterPostRequest(url, data, callback) {
        $.ajax({
            type: "POST",
            url: url,
            dataType: "json",
            data: JSON.stringify(data),
            traditional: true,
            contentType: "application/json",
            success: function (result) {

            },
            error: function () {
                swal("错误", "404", "error");
            }
        });
    }
</script>

</body>

</html>